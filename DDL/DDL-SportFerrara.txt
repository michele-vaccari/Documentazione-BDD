CREATE TABLE IF NOT EXISTS `UTENTE` (
	`Email` VARCHAR(30) NOT NULL,
	`Password` VARCHAR(32) NOT NULL,
	`Chiave_privata` VARCHAR(32) NOT NULL,
	`Nome` VARCHAR(30) NOT NULL,
	`Cognome` VARCHAR(30) NOT NULL,
	`Tipo` VARCHAR(1) NOT NULL,
	`Attivo` BOOLEAN NOT NULL DEFAULT TRUE,
	PRIMARY KEY (`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `AMMINISTRATORE` (
	`Email_U` VARCHAR(30) NOT NULL,
	PRIMARY KEY (`Email_U`),
	FOREIGN KEY (`Email_U`) REFERENCES UTENTE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `REGISTRATO` (
	`Email_U` VARCHAR(30) NOT NULL,
	`Email_A` VARCHAR(30) NOT NULL,
	`Telefono` VARCHAR(15) NOT NULL,
	`Indirizzo` VARCHAR(50) NOT NULL,
	PRIMARY KEY (`Email_U`),
	FOREIGN KEY (`Email_U`) REFERENCES UTENTE(`Email`),
	FOREIGN KEY (`Email_A`) REFERENCES AMMINISTRATORE(`Email_U`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `ARBITRO` (
	`Email_R` VARCHAR(30) NOT NULL,
	`Data_di_nascita` DATE NOT NULL,
	`Nazionalita` VARCHAR(50) NOT NULL,
	`Foto` VARCHAR(50) NOT NULL,
	PRIMARY KEY (`Email_R`),
	FOREIGN KEY (`Email_R`) REFERENCES REGISTRATO(`Email_U`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `GESTORE_SQUADRA` (
	`Email_R` VARCHAR(30) NOT NULL,
	PRIMARY KEY (`Email_R`),
	FOREIGN KEY (`Email_R`) REFERENCES REGISTRATO(`Email_U`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `TORNEO` (
	`Id` INT UNSIGNED NOT NULL,
	`Email_A` VARCHAR(30) NOT NULL,
	`Tipo` CHAR(1) NOT NULL,
	`Nome` VARCHAR(30) NOT NULL,
	`Descrizione` TEXT(5000),
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Email_A`) REFERENCES AMMINISTRATORE(`Email_U`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `PARTITA` (
	`Id` INT UNSIGNED NOT NULL,
	`Tipo_torneo` CHAR(1) NOT NULL,
	`Luogo` VARCHAR(30) NOT NULL,
	`Data` DATE NOT NULL,
	`Ora` TIME NOT NULL,
	PRIMARY KEY (`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `REFERTO` (
	`Id` INT UNSIGNED NOT NULL,
	`Id_P` INT UNSIGNED NOT NULL,
	`Email_AR` VARCHAR(30) NOT NULL,
	`Ora_inizio` TIME NOT NULL,
	`Ora_fine` TIME NOT NULL,
	`Risultato` VARCHAR(10) NOT NULL,
	`Compilato` BOOLEAN NOT NULL,
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Id_P`) REFERENCES PARTITA(`Id`),
	FOREIGN KEY (`Email_AR`) REFERENCES ARBITRO(`Email_R`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `SQUADRA` (
	`Id` INT UNSIGNED NOT NULL,
	`Email_G` VARCHAR(30) NOT NULL,
	`Compilata` BOOLEAN NOT NULL,
	`Nome` VARCHAR(30) NOT NULL,
	`Descrizione` TEXT(5000),
	`Sede` VARCHAR(30) NOT NULL,
	`Logo` VARCHAR(50) NOT NULL,
	`Immagine` VARCHAR(50) NOT NULL,
	`Nome_sponsor` VARCHAR(30) NOT NULL,
	`Logo_sponsor` VARCHAR(50) NOT NULL,
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Email_G`) REFERENCES GESTORE_SQUADRA(`Email_R`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `CLASSIFICA` (
	`Id_T` INT UNSIGNED NOT NULL,
	`Id_S` INT UNSIGNED NOT NULL,
	`Punti` INT UNSIGNED DEFAULT 0,
	`Vittorie` INT UNSIGNED DEFAULT 0,
	`Sconfitte` INT UNSIGNED DEFAULT 0,
	`Pareggi` INT UNSIGNED DEFAULT 0,
	`Partite` INT UNSIGNED DEFAULT 0,
	`Goal_fatti` INT UNSIGNED DEFAULT 0,
	`Goal_subiti` INT UNSIGNED DEFAULT 0,
	PRIMARY KEY (`Id_T`, `Id_S`),
	FOREIGN KEY (`Id_T`) REFERENCES TORNEO(`Id`),
	FOREIGN KEY (`Id_S`) REFERENCES SQUADRA(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `GIOCATORE` (
	`Id_S` INT UNSIGNED NOT NULL,
	`Id` INT UNSIGNED NOT NULL,
	`Attivo` BOOLEAN DEFAULT TRUE,
	`Numero_maglia` INT UNSIGNED,
	`Ruolo` VARCHAR(50) NOT NULL,
	`Nome` VARCHAR(30) NOT NULL,
	`Cognome` VARCHAR(30) NOT NULL,
	`Data_di_nascita` DATE NOT NULL,
	`Nazionalita` VARCHAR(20) NOT NULL,
	`Foto` VARCHAR(50) NOT NULL,
	`Descrizione` TEXT(5000),
	`Goal` INT UNSIGNED DEFAULT 0,
	`Ammonizioni` INT UNSIGNED DEFAULT 0,
	`Espulsioni` INT UNSIGNED DEFAULT 0,
	PRIMARY KEY (`Id_S`, `Id`),
	FOREIGN KEY (`Id_S`) REFERENCES SQUADRA(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `MARCATORE` (
	`Id_R` INT UNSIGNED NOT NULL,
	`Id_S` INT UNSIGNED NOT NULL,
	`Id_G` INT UNSIGNED NOT NULL,
	`Goal` INT UNSIGNED DEFAULT 0,
	PRIMARY KEY (`Id_R`, `Id_G`),
	FOREIGN KEY (`Id_R`) REFERENCES REFERTO(`Id`),
	FOREIGN KEY (`Id_S`,`Id_G`) REFERENCES GIOCATORE(`Id_S`,`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `PARTECIPANO` (
	`Id_S` INT UNSIGNED NOT NULL,
	`Id_T` INT UNSIGNED NOT NULL,
	PRIMARY KEY (`Id_S`, `Id_T`),
	FOREIGN KEY (`Id_S`) REFERENCES SQUADRA(`Id`),
	FOREIGN KEY (`Id_T`) REFERENCES TORNEO(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `CARTELLINO` (
	`Id_R` INT UNSIGNED NOT NULL,
	`Id_S` INT UNSIGNED NOT NULL,
	`Id_G` INT UNSIGNED NOT NULL,
	`Numero` INT UNSIGNED DEFAULT 0,
	`Ammonizione` BOOLEAN,
	`Espulsione` BOOLEAN,
	PRIMARY KEY (`Id_R`, `Id_G`),
	FOREIGN KEY (`Id_R`) REFERENCES REFERTO(`Id`),
	FOREIGN KEY (`Id_S`,`Id_G`) REFERENCES GIOCATORE(`Id_S`,`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `SCELTO` (
	`Id_P` INT UNSIGNED NOT NULL,
	`Email_AR` VARCHAR(30) NOT NULL,
	`Email_A` VARCHAR(30) NOT NULL,
	PRIMARY KEY (`Id_P`, `Email_AR`, `Email_A`),
	FOREIGN KEY (`Id_P`) REFERENCES PARTITA(`Id`),
	FOREIGN KEY (`Email_AR`) REFERENCES ARBITRO(`Email_R`),
	FOREIGN KEY (`Email_A`) REFERENCES AMMINISTRATORE(`Email_U`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `FORMAZIONE` (
	`Id_R` INT UNSIGNED NOT NULL,
	`Id_S` INT UNSIGNED NOT NULL,
	`Id_G` INT UNSIGNED NOT NULL,
	`Riserva` BOOLEAN NOT NULL,
	PRIMARY KEY (`Id_R`, `Id_S`, `Id_G`),
	FOREIGN KEY (`Id_R`) REFERENCES REFERTO(`Id`),
	FOREIGN KEY (`Id_S`,`Id_G`) REFERENCES GIOCATORE(`Id_S`,`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `GIOCANO` (
	`Id_P` INT UNSIGNED NOT NULL,
	`Id_S1` INT UNSIGNED NOT NULL,
	`Id_S2` INT UNSIGNED NOT NULL,
	`Id_T` INT UNSIGNED NOT NULL,
	`Fase_o_giornata` VARCHAR(30) NOT NULL,
	PRIMARY KEY (`Id_P`, `Id_S1`, `Id_S2`, `Id_T`),
	FOREIGN KEY (`Id_P`) REFERENCES PARTITA(`Id`),
	FOREIGN KEY (`Id_S1`) REFERENCES SQUADRA(`Id`),
	FOREIGN KEY (`Id_S2`) REFERENCES SQUADRA(`Id`),
	FOREIGN KEY (`Id_T`) REFERENCES TORNEO(`Id`)
) ENGINE = InnoDB;