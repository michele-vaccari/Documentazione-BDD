CREATE TABLE IF NOT EXISTS `UTENTE_AMMINISTRATORE` (
	`Email` VARCHAR(100) NOT NULL,
	`Email_USA` VARCHAR(100) NOT NULL DEFAULT 'admin@bins.com',
	`Password` VARCHAR(32) NOT NULL,
	`Data_di_registrazione` TIMESTAMP NOT NULL,
	`Attivo` BOOLEAN NOT NULL DEFAULT TRUE,
	`Nome` VARCHAR(50) NOT NULL,
	`Cognome` VARCHAR(50) NOT NULL,
	`Data_di_nascita` DATE NOT NULL,
	`SSN` VARCHAR(16) NOT NULL,
	PRIMARY KEY (`Email`),
	FOREIGN KEY (`Email_USA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `UTENTE_REGISTRATO` (
	`Email` VARCHAR(100) NOT NULL,
	`Email_UA` VARCHAR(100) NOT NULL DEFAULT 'admin@bins.com',
	`Password` VARCHAR(32) NOT NULL,
	`Data_di_registrazione` TIMESTAMP NOT NULL,
	`Attivo` BOOLEAN NOT NULL DEFAULT TRUE,
	`Nome` VARCHAR(50) NOT NULL,
	`Cognome` VARCHAR(50) NOT NULL,
	`Data_di_nascita` DATE NOT NULL,
	`SSN` VARCHAR(16) NOT NULL,
	PRIMARY KEY (`Email`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `FATTURA` (
	`Id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
	`PIVA` VARCHAR(16) NOT NULL,
	`Denominazione` VARCHAR(100) NOT NULL,
	`Nazione` VARCHAR(50) NOT NULL,
	`Provincia` VARCHAR(50) NOT NULL,
	`Citta` VARCHAR(50) NOT NULL,
	`CAP` VARCHAR(5) NOT NULL,
	`Via` VARCHAR(100) NOT NULL,
	`Numero_civico` VARCHAR(10) NOT NULL,
	`Numero_di_telefono` VARCHAR(30) NOT NULL,
	`Importo` DOUBLE(8,2) UNSIGNED NOT NULL DEFAULT '0.00',
	`Data` TIMESTAMP NOT NULL,
	PRIMARY KEY (`Id`)
) ENGINE = InnoDB AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS `PAGAMENTO` (
	`Id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
	`Id_F` INT UNSIGNED NOT NULL,
	`Tipo` VARCHAR(50) NOT NULL,
	`Data_pagamento` TIMESTAMP NOT NULL,
	`Importo` DOUBLE(8,2) UNSIGNED NOT NULL DEFAULT '0.00',
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Id_F`) REFERENCES FATTURA(`Id`)
) ENGINE = InnoDB AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS `ORDINE` (
	`Id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
	`Id_P` INT UNSIGNED NOT NULL,
	`Email_UA` VARCHAR(100) NOT NULL,
	`Email_UR` VARCHAR(100) NOT NULL,
	`Data` TIMESTAMP NOT NULL,
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`),
	FOREIGN KEY (`Email_UR`) REFERENCES UTENTE_REGISTRATO(`Email`),
	FOREIGN KEY (`Id_P`) REFERENCES PAGAMENTO(`Id`)
) ENGINE = InnoDB AUTO_INCREMENT=1;

CREATE TABLE IF NOT EXISTS `TRACKING` (
	`Id_O` INT UNSIGNED NOT NULL,
	`Stato` VARCHAR(100) NOT NULL,
	`Data` TIMESTAMP NOT NULL,
	PRIMARY KEY (`Id_O`),
	FOREIGN KEY (`Id_O`) REFERENCES ORDINE(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `INDIRIZZO_DI_SPEDIZIONE` (
	`Id_O` INT UNSIGNED NOT NULL,
	`Tipo` VARCHAR(20) NOT NULL,
	`Costo` DOUBLE(8,2) UNSIGNED NOT NULL DEFAULT '0.00',
	`Nome_e_cognome` VARCHAR(100) NOT NULL,
	`Nazione` VARCHAR(50) NOT NULL,
	`Provincia` VARCHAR(50) NOT NULL,
	`Citta` VARCHAR(50) NOT NULL,
	`CAP` VARCHAR(5) NOT NULL,
	`Via` VARCHAR(100) NOT NULL,
	`Numero_civico` VARCHAR(10) NOT NULL,
	`Numero_di_telefono` VARCHAR(30) NOT NULL,
	`Note` TEXT(1000),
	PRIMARY KEY (`Id_O`),
	FOREIGN KEY (`Id_O`) REFERENCES ORDINE(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `LISTA_DELLA_SPESA` (
	`Email_UR` VARCHAR(100) NOT NULL,
	`Nome` VARCHAR(50) NOT NULL,
	`Note` TEXT(1000),
	PRIMARY KEY (`Email_UR`, `Nome`),
	FOREIGN KEY (`Email_UR`) REFERENCES UTENTE_REGISTRATO(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `INDIRIZZO` (
	`Email_UR` VARCHAR(100) NOT NULL,
	`Nome` VARCHAR(50) NOT NULL,
	`Nazione` VARCHAR(50) NOT NULL,
	`Provincia` VARCHAR(50) NOT NULL,
	`Citta` VARCHAR(50) NOT NULL,
	`CAP` VARCHAR(5) NOT NULL,
	`Via` VARCHAR(100) NOT NULL,
	`Numero_civico` VARCHAR(10) NOT NULL,
	`Numero_di_telefono` VARCHAR(30) NOT NULL,
	PRIMARY KEY (`Email_UR`, `Nome`),
	FOREIGN KEY (`Email_UR`) REFERENCES UTENTE_REGISTRATO(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `RICETTA` (
	`Nome` VARCHAR(50) NOT NULL,
	`Autore` VARCHAR(50) NOT NULL,
	`Email_UA` VARCHAR(50) NOT NULL,
	`Tempo_di_preparazione` TIME NOT NULL,
	`Preparazione` TEXT(22000) NOT NULL,
	`Attiva` BOOLEAN NOT NULL DEFAULT TRUE,
	PRIMARY KEY (`Nome`, `Autore`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `MARCHIO` (
	`Nome` VARCHAR(50) NOT NULL,
	`Email_UA` VARCHAR(50) NOT NULL,
	`Descrizione` TEXT(2000) NOT NULL,
	`Immagine` VARCHAR(100) NOT NULL,
	PRIMARY KEY (`Nome`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `CARATTERISTICA` (
	`Nome` VARCHAR(50) NOT NULL,
	`Email_UA` VARCHAR(50) NOT NULL,
	`Descrizione` TEXT(2000) NOT NULL,
	PRIMARY KEY (`Nome`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `REPARTO` (
	`Nome` VARCHAR(50) NOT NULL,
	`Email_UA` VARCHAR(50) NOT NULL,
	`Descrizione` TEXT(2000) NOT NULL,
	PRIMARY KEY (`Nome`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `COUPON` (
	`Id` INT UNSIGNED NOT NULL,	
	`Email_UA` VARCHAR(50) NOT NULL,
	`Email_UR` VARCHAR(50) NOT NULL,
	`Ente_erogatore` VARCHAR(50) NOT NULL,
	`Importo` DOUBLE(8,2) NOT NULL DEFAULT '0.00',
	PRIMARY KEY (`Id`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`),
	FOREIGN KEY (`Email_UR`) REFERENCES UTENTE_REGISTRATO(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `PRODOTTO` (
	`EAN` VARCHAR(13) NOT NULL,
	`Nome_M` VARCHAR(50) NOT NULL,
	`Nome_R` VARCHAR(50) NOT NULL,
	`Data_inserimento` TIMESTAMP NOT NULL,
	`Nome` VARCHAR(100) NOT NULL,
	`Descrizione` TEXT(2000) NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	`Peso` INT UNSIGNED NOT NULL,
	`Prezzo_unitario` DOUBLE(8,2) UNSIGNED NOT NULL DEFAULT '0.00',
	`Immagine` VARCHAR(100) NOT NULL,
	`Attivo` BOOLEAN NOT NULL DEFAULT TRUE,
	PRIMARY KEY (`EAN`),
	FOREIGN KEY (`Nome_M`) REFERENCES MARCHIO(`Nome`),
	FOREIGN KEY (`Nome_R`) REFERENCES RICETTA(`Nome`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `SCADENZA` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	`Data_di_scadenza` DATE NOT NULL,
	PRIMARY KEY (`EAN_P`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `HA_PARTICOLARE` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Nome_C` VARCHAR(50) NOT NULL,
	PRIMARY KEY (`EAN_P`, `Nome_C`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Nome_C`) REFERENCES CARATTERISTICA(`Nome`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `IMPIEGATO_IN` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Nome_R` VARCHAR(50) NOT NULL,
	`Autore_R` VARCHAR(100) NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	PRIMARY KEY (`EAN_P`, `Nome_R`, `Autore_R`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Nome_R`,`Autore_R`) REFERENCES RICETTA(`Nome`,`Autore`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `CONTENUTO_IN_LISTA` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Email_UR` VARCHAR(100) NOT NULL,
	`Nome_L` VARCHAR(50) NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	PRIMARY KEY (`EAN_P`, `Email_UR`, `Nome_L`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Email_UR`,`Nome_L`) REFERENCES LISTA_DELLA_SPESA(`Email_UR`,`Nome`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `CONTENUTO_IN_CARRELLO` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Email_UR` VARCHAR(100) NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	PRIMARY KEY (`EAN_P`, `Email_UR`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Email_UR`) REFERENCES UTENTE_REGISTRATO(`Email`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `COMPONE` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Id_O` INT UNSIGNED NOT NULL,
	`Quantita` INT UNSIGNED NOT NULL,
	PRIMARY KEY (`EAN_P`, `Id_O`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Id_O`) REFERENCES ORDINE(`Id`)
) ENGINE = InnoDB;

CREATE TABLE IF NOT EXISTS `GESTISCE_PRODOTTI` (
	`EAN_P` VARCHAR(13) NOT NULL,
	`Email_UA` VARCHAR(100) NOT NULL,
	PRIMARY KEY (`EAN_P`, `Email_UA`),
	FOREIGN KEY (`EAN_P`) REFERENCES PRODOTTO(`EAN`),
	FOREIGN KEY (`Email_UA`) REFERENCES UTENTE_AMMINISTRATORE(`Email`)
) ENGINE = InnoDB;